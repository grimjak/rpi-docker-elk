input {
  tcp {
    port => 5000
    type => syslog
  }
  udp {
    port => 5000
    type => syslog
  }
}

## Add your filters / logstash plugins configuration here
filter {
  if [path] =~ "sonicwall" {
    grok {
        match => { "message" => '%{SYSLOGTIMESTAMP:syslog_timestamp}.*pri=%{POSINT:pri}.*msg="%{DATA:msg}"(.*appName="%{DATA:appName}"),?(.*usr="%{WORD:usr}")?.*src=%{IPV4:srcip}:%{POSINT:srcport}:%{WORD:srcint}.*dst=%{IPV4:dstip}:%{POSINT:dstip}:%{WORD:dstint}(.*srcMac=%{COMMONMAC:srcMac}.*dstMac=%{COMMONMAC:dstMac})?.*fw_action="%{WORD:fw_action}"' }
    }
  }
}

output {
  elasticsearch { hosts => ["elasticsearch:9200"] }
  stdout { codec => rubydebug }
}